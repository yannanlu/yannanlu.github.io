<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_112) on Sat Jul 20 07:51:54 EDT 2019 -->
<title>HTTPMessenger</title>
<meta name="date" content="2019-07-20">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="HTTPMessenger";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/qbroker/jms/FTPSMessenger.html" title="class in org.qbroker.jms"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../org/qbroker/jms/JDBCMessenger.html" title="class in org.qbroker.jms"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/qbroker/jms/HTTPMessenger.html" target="_top">Frames</a></li>
<li><a href="HTTPMessenger.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.qbroker.jms</div>
<h2 title="Class HTTPMessenger" class="title">Class HTTPMessenger</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.qbroker.jms.HTTPMessenger</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">HTTPMessenger</span>
extends java.lang.Object</pre>
<div class="block">HTTPMessenger connects to a web server and initializes one of the operations,
 such as retrieve, download and store, or other commands.
<br/><br/>
 There are four methods, retrieve(), download(), fulfill() and store().  The
 first method, retrieve(), is used to retrieve content from a web server.
 The method of download() is used for synchronous requests.  The method of
 fulfill() is for asynchronous requests with the initial request and multiple
 subsequent checks on the status.  The method of store() is used for putting
 or posting content to a web server. Except for retrieve(), the rest of
 methods treat the return code of 2xx as a success. If IgnoreHTTP412 is set
 to be true, the methods of download(), fulfill() and store() will not treat
 the return code of 412 as a failure.
<br/><br/>
 ResponseProperty is a map for retrieving the header properties from an HTTP
 response. It contains multiple key-value pairs with key for an HTTP header
 and value for a property name of messages. Once the response is back,
 the values of the selected headers will be copied into the message. On the
 other hand, RequestProperty is a map for setting header properties on an
 HTTP request. Before sending the request to an HTTP service, those selected
 headers will be set via copying the properties from the message.
<br/><br/>
 This is NOT MT-Safe.  Therefore, you need to use multiple instances to
 achieve your MT goal.
<br/></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>yannanlu@yahoo.com</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#HTTPMessenger-java.util.Map-">HTTPMessenger</a></span>(java.util.Map&nbsp;props)</code>
<div class="block">Creates new HTTPMessenger</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#close--">close</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#download-org.qbroker.common.XQueue-">download</a></span>(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)</code>
<div class="block">It gets a JMS message from xq that contains a URL to be downloaded and
 downloads the web page via http.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#fulfill-org.qbroker.common.XQueue-">fulfill</a></span>(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)</code>
<div class="block">It gets a JMS message from xq that contains a static URL for the initial
 asynchronous request and a dynamic URL template for a subsequent checking
 on the status of the fulfillment via http.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#getOperation--">getOperation</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#getURI--">getURI</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#isConnected--">isConnected</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#reconnect--">reconnect</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#retrieve-org.qbroker.common.XQueue-">retrieve</a></span>(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)</code>
<div class="block">retrieve a page from web server and put it to an XQ</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/jms/HTTPMessenger.html#store-org.qbroker.common.XQueue-">store</a></span>(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)</code>
<div class="block">It gets a JMS Message from the XQueue and stores its content into a
 URL via http POST continuously.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="HTTPMessenger-java.util.Map-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>HTTPMessenger</h4>
<pre>public&nbsp;HTTPMessenger(java.util.Map&nbsp;props)</pre>
<div class="block">Creates new HTTPMessenger</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="retrieve-org.qbroker.common.XQueue-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>retrieve</h4>
<pre>public&nbsp;void&nbsp;retrieve(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)
              throws java.io.IOException,
                     javax.jms.JMSException</pre>
<div class="block">retrieve a page from web server and put it to an XQ</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.jms.JMSException</code></dd>
</dl>
</li>
</ul>
<a name="download-org.qbroker.common.XQueue-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>download</h4>
<pre>public&nbsp;void&nbsp;download(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)
              throws java.io.IOException,
                     <a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a>,
                     javax.jms.JMSException</pre>
<div class="block">It gets a JMS message from xq that contains a URL to be downloaded and
 downloads the web page via http.  It puts the content of the page into
 the message body and sends it back.  The requester at the other end
 of the XQueue can easily read the content out of the message.
<br/><br/>
 Since the download operation relies on a request, this method will
 intercept the request and process it.  The incoming message is required
 to be writeable.  The method will set a String property of the message
 specified by the RCField with the return code, indicating the status
 of the process to fulfill the request.  The requester is required to
 check the value of the property once it gets the message back.  If
 the return code is 0, the download is successful.  Otherwise, the
 message body will not contain the content out of download operation.
<br/><br/>
 It supports GET, POST and PUT.  For POST, IsPost must be set to true.
 For PUT, UsePut has to be set to true. The Template or message body
 must contain the query content for POST or PUT. If it is GET, Template
 will be used to set the dynamic path for REST.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a></code></dd>
<dd><code>javax.jms.JMSException</code></dd>
</dl>
</li>
</ul>
<a name="fulfill-org.qbroker.common.XQueue-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fulfill</h4>
<pre>public&nbsp;void&nbsp;fulfill(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)
             throws java.io.IOException,
                    <a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a>,
                    javax.jms.JMSException</pre>
<div class="block">It gets a JMS message from xq that contains a static URL for the initial
 asynchronous request and a dynamic URL template for a subsequent checking
 on the status of the fulfillment via http. After the initial request, it
 waits and keeps checking on the status of the fulfillment. Once the
 request is fulfilled, it puts the fulfilled response into the message
 body and sends it back. The requester at the other end of the XQueue can
 easily read the content out of the message.
<br/><br/>
 Since the fulfill operation relies on an initial request and multiple
 subsequent checks, this method will intercept the JMS request and
 process it.  The incoming message is required to be writeable.  The
 method will set a String property of the message specified by the
 RCField with the return code, indicating the status of the fulfillment
 process. The requester is required to check the value of the property
 once it gets the message back.  If the return code is 0, the fulfillment
 is successful.  Otherwise, the message body will not contain the result.
<br/><br/>
 For the initial request, it supports both GET and POST.  If it is POST,
 IsPost must be set to true.  The Template or message body must contains
 the fulfillment content for POST.  If it is GET, Template will be used
 to set the dynamic path for the REST calls.
<br/><br/>
 The incoming message is also supposed to have a substitution statement
 to rewrite the URL for the subsequent rest calls to check the response.
 It should be stored in SubField if it is defined.  For the subsequent
 rest calls, it only supports GET.  The URL substitution only formats the
 content from the initial response.  For each subsequent rest call,
 the method evaluates the response status.  It it is OK, the content of
 the response will be set to the message body.  Otherwise, it will
 sleep for a while defined by SleepTime and retries up to Retry times.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a></code></dd>
<dd><code>javax.jms.JMSException</code></dd>
</dl>
</li>
</ul>
<a name="store-org.qbroker.common.XQueue-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>store</h4>
<pre>public&nbsp;void&nbsp;store(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)
           throws java.io.IOException,
                  <a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a>,
                  javax.jms.JMSException</pre>
<div class="block">It gets a JMS Message from the XQueue and stores its content into a
 URL via http POST continuously.
<br/><br/>
 It will always try to retrieve the URL from the field specified by
 FieldName property.  If the message does not contain the URL, the method
 will use the default URL defined by URI property.
<br/><br/>
 The store operation also supports the requests.  If the XAMode has
 enabled the XA_CLIENT bit, it will treat the message as a request from
 the uplink.  In this case, the incoming message is required
 to be writeable.  The method will set a String property of the message
 specified by the RCField with the return code, indicating the status
 of the process to fulfill the request.  The requester is supposed to
 check the value of the property once it gets the message back.  If
 the return code is 0, the operation is successful.  Otherwise, the
 request will be dropped due to failures.  On the other hand, if the
 XA_CLIENT bit has been disabled by XAMode, the incoming message will
 not be modified.
<br/><br/>
 If the XQueue has enabled the EXTERNAL_XA bit, it will also acknowledge
 the messages.  This method is MT-Safe.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a></code></dd>
<dd><code>javax.jms.JMSException</code></dd>
</dl>
</li>
</ul>
<a name="close--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;close()</pre>
</li>
</ul>
<a name="reconnect--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reconnect</h4>
<pre>public&nbsp;java.lang.String&nbsp;reconnect()</pre>
</li>
</ul>
<a name="getOperation--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOperation</h4>
<pre>public&nbsp;java.lang.String&nbsp;getOperation()</pre>
</li>
</ul>
<a name="getURI--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getURI</h4>
<pre>public&nbsp;java.lang.String&nbsp;getURI()</pre>
</li>
</ul>
<a name="isConnected--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>isConnected</h4>
<pre>public&nbsp;boolean&nbsp;isConnected()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/qbroker/jms/FTPSMessenger.html" title="class in org.qbroker.jms"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../org/qbroker/jms/JDBCMessenger.html" title="class in org.qbroker.jms"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/qbroker/jms/HTTPMessenger.html" target="_top">Frames</a></li>
<li><a href="HTTPMessenger.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
