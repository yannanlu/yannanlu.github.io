<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Sat Jun 02 21:51:41 EDT 2018 -->
<title>RiakMessenger</title>
<meta name="date" content="2018-06-02">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="RiakMessenger";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/qbroker/jms/RedisMessenger.html" title="class in org.qbroker.jms"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../org/qbroker/jms/RMQMessenger.html" title="class in org.qbroker.jms"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/qbroker/jms/RiakMessenger.html" target="_top">Frames</a></li>
<li><a href="RiakMessenger.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#fields_inherited_from_class_org.qbroker.net.RiakConnector">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.qbroker.jms</div>
<h2 title="Class RiakMessenger" class="title">Class RiakMessenger</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../../org/qbroker/net/RiakConnector.html" title="class in org.qbroker.net">org.qbroker.net.RiakConnector</a></li>
<li>
<ul class="inheritance">
<li>org.qbroker.jms.RiakMessenger</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">RiakMessenger</span>
extends <a href="../../../org/qbroker/net/RiakConnector.html" title="class in org.qbroker.net">RiakConnector</a></pre>
<div class="block">RiakMessenger connects to a Riak database specified by URI and
 initializes the operations of fetch, store and download with JMS Messages on
 various data buckets.
<br/><br/>
 This is NOT MT-Safe.  Therefore, you need to use multiple instances to
 achieve your MT goal.
<br/></div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>yannanlu@yahoo.com</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_org.qbroker.net.RiakConnector">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;org.qbroker.net.<a href="../../../org/qbroker/net/RiakConnector.html" title="class in org.qbroker.net">RiakConnector</a></h3>
<code><a href="../../../org/qbroker/net/RiakConnector.html#ACTION_COUNT">ACTION_COUNT</a>, <a href="../../../org/qbroker/net/RiakConnector.html#ACTION_DELETE">ACTION_DELETE</a>, <a href="../../../org/qbroker/net/RiakConnector.html#ACTION_FETCH">ACTION_FETCH</a>, <a href="../../../org/qbroker/net/RiakConnector.html#ACTION_LIST">ACTION_LIST</a>, <a href="../../../org/qbroker/net/RiakConnector.html#ACTION_STORE">ACTION_STORE</a>, <a href="../../../org/qbroker/net/RiakConnector.html#hostname">hostname</a>, <a href="../../../org/qbroker/net/RiakConnector.html#isConnected">isConnected</a>, <a href="../../../org/qbroker/net/RiakConnector.html#password">password</a>, <a href="../../../org/qbroker/net/RiakConnector.html#port">port</a>, <a href="../../../org/qbroker/net/RiakConnector.html#riakClient">riakClient</a>, <a href="../../../org/qbroker/net/RiakConnector.html#uri">uri</a>, <a href="../../../org/qbroker/net/RiakConnector.html#username">username</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../org/qbroker/jms/RiakMessenger.html#RiakMessenger(java.util.Map)">RiakMessenger</a></strong>(java.util.Map&nbsp;props)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/RiakMessenger.html#download(org.qbroker.common.XQueue)">download</a></strong>(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)</code>
<div class="block">It listens to an XQueue for incoming JMS messages and extracts the
 bucket name and the key name from each message.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/RiakMessenger.html#fetch(org.qbroker.common.XQueue)">fetch</a></strong>(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)</code>
<div class="block">It fetches content with the default key from the Riak service and
 loads content into a message before sending it to the XQ.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/RiakMessenger.html#getOperation()">getOperation</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/RiakMessenger.html#store(org.qbroker.common.XQueue)">store</a></strong>(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)</code>
<div class="block">It gets a JMS Message from the XQueue and stores its content into a
 bucket with the given key.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_org.qbroker.net.RiakConnector">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;org.qbroker.net.<a href="../../../org/qbroker/net/RiakConnector.html" title="class in org.qbroker.net">RiakConnector</a></h3>
<code><a href="../../../org/qbroker/net/RiakConnector.html#close()">close</a>, <a href="../../../org/qbroker/net/RiakConnector.html#delete(java.lang.String, java.lang.String)">delete</a>, <a href="../../../org/qbroker/net/RiakConnector.html#fetch(java.lang.String, java.lang.String)">fetch</a>, <a href="../../../org/qbroker/net/RiakConnector.html#fetchBucket(java.lang.String)">fetchBucket</a>, <a href="../../../org/qbroker/net/RiakConnector.html#getURI()">getURI</a>, <a href="../../../org/qbroker/net/RiakConnector.html#isConnected()">isConnected</a>, <a href="../../../org/qbroker/net/RiakConnector.html#list()">list</a>, <a href="../../../org/qbroker/net/RiakConnector.html#main(java.lang.String[])">main</a>, <a href="../../../org/qbroker/net/RiakConnector.html#reconnect()">reconnect</a>, <a href="../../../org/qbroker/net/RiakConnector.html#store(java.lang.String, java.lang.String, java.lang.String)">store</a>, <a href="../../../org/qbroker/net/RiakConnector.html#store(java.lang.String, java.lang.String, java.lang.String, java.util.Map)">store</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="RiakMessenger(java.util.Map)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>RiakMessenger</h4>
<pre>public&nbsp;RiakMessenger(java.util.Map&nbsp;props)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="fetch(org.qbroker.common.XQueue)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fetch</h4>
<pre>public&nbsp;void&nbsp;fetch(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)
           throws <a href="../../../org/qbroker/common/NonSQLException.html" title="class in org.qbroker.common">NonSQLException</a>,
                  javax.jms.JMSException</pre>
<div class="block">It fetches content with the default key from the Riak service and
 loads content into a message before sending it to the XQ.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../org/qbroker/common/NonSQLException.html" title="class in org.qbroker.common">NonSQLException</a></code></dd>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="store(org.qbroker.common.XQueue)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>store</h4>
<pre>public&nbsp;void&nbsp;store(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)
           throws <a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a>,
                  <a href="../../../org/qbroker/common/NonSQLException.html" title="class in org.qbroker.common">NonSQLException</a>,
                  javax.jms.JMSException</pre>
<div class="block">It gets a JMS Message from the XQueue and stores its content into a
 bucket with the given key.
<br/><br/>
 It always tries to retrieve the bucket name from the field specified
 by BucketField and the key name from the field specified by the
 KeyField.  If the message does not contain the bucket or key, the method
 will use the default values.
<br/><br/>
 If the XQueue has enabled the EXTERNAL_XA bit, it will also acknowledge
 the messages.  This method is MT-Safe.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a></code></dd>
<dd><code><a href="../../../org/qbroker/common/NonSQLException.html" title="class in org.qbroker.common">NonSQLException</a></code></dd>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="download(org.qbroker.common.XQueue)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>download</h4>
<pre>public&nbsp;void&nbsp;download(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)
              throws <a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a>,
                     <a href="../../../org/qbroker/common/NonSQLException.html" title="class in org.qbroker.common">NonSQLException</a>,
                     javax.jms.JMSException</pre>
<div class="block">It listens to an XQueue for incoming JMS messages and extracts the
 bucket name and the key name from each message.  Then it downloads the
 content from the Riak server and loads the content to the message body.
<br/><br/>
 If the MaxIdleTime is set to none-zero, it will monitor the idle time
 and will throw TimeoutException once the idle time exceeds MaxIdleTime.
 it is up to the caller to handle this exception.
<br/><br/>
 The original message will not be modified.  If the XQueue has enabled
 the EXTERNAL_XA bit, it will also acknowledge the messages also.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a></code></dd>
<dd><code><a href="../../../org/qbroker/common/NonSQLException.html" title="class in org.qbroker.common">NonSQLException</a></code></dd>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="getOperation()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getOperation</h4>
<pre>public&nbsp;java.lang.String&nbsp;getOperation()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/qbroker/jms/RedisMessenger.html" title="class in org.qbroker.jms"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../org/qbroker/jms/RMQMessenger.html" title="class in org.qbroker.jms"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/qbroker/jms/RiakMessenger.html" target="_top">Frames</a></li>
<li><a href="RiakMessenger.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#fields_inherited_from_class_org.qbroker.net.RiakConnector">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
