<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_112) on Sat Nov 23 12:53:27 EST 2019 -->
<title>NewlogFetcher</title>
<meta name="date" content="2019-11-23">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="NewlogFetcher";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/qbroker/common/LongKeyChain.html" title="class in org.qbroker.common"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../org/qbroker/common/NonSQLException.html" title="class in org.qbroker.common"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/qbroker/common/NewlogFetcher.html" target="_top">Frames</a></li>
<li><a href="NewlogFetcher.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.qbroker.common</div>
<h2 title="Class NewlogFetcher" class="title">Class NewlogFetcher</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.qbroker.common.NewlogFetcher</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">NewlogFetcher</span>
extends java.lang.Object</pre>
<div class="block">NewlogFetcher reads the new log entries from a sequential log file
<br/><br/>
 Use NewlogFetcher to check a sequential log file repetitively.  It only
 picks up the newly updated log entries.  It guarantees the order and the
 integrity of the new logs.  In order to guarantee the order and
 the integrity, each log entry should have a timestamp and the value of
 the timestamp has to be in non-decreasing order, i.e., the timestamp
 of the log is always no later than those of the following logs.
<br/><br/>
 In order to keep tracking the positions, NewlogFetcher relies on a
 reference file.  The reference file contains the position of the reference
 log, its timestamp and the offset of the objective log.  A reference
 log is a log entry with a valid timestamp and is used as the reference to
 locate the objective log.  It may or may not be in the current log file.
 The objective log is the first log entry in the current log file that has
 the timestamp later than the reference timestamp.  The offset is the byte
 count from the beginning of the objective log to end of the last processed
 log entry.  Any log after the offset is treated as a new log.  In fact,
 NewlogFetcher frequently opens the log file and looks for the objective log.
 It then scans the offset bytes to locate the new logs.
<br/><br/>
 Here are the rules for the reference file:<br/><br/>
 (1) If there is the reference file, use it and trust it.<br/>
 (2) If there is no reference file, use the timestamp of the current log file
 as the timestamp of the reference log and set the position of reference log
 and the offset to 0.<br/>
 (3) If there is no current log file, try the timestamp of the old log
 file.<br/>
 (4) If still no reference, use the default reference (0 currentTime 0).<br/>
 (5) If there is a mismatch to the position of the reference log, trust
 the timestamp of the reference log and search for the objective log in
 the current log file.  The objective log is the first log entry with
 a timestamp later than the reference timestamp.<br/>
 (6) If there is a mismatch to the offset of the objective log, trust the
 current log first.<br/>
 (7) If it does not find a objective log, reset the offset to 0.<br/>
<br/><br/>
 The reference file is not required.  But if the file is not defined, you
 will have to set SaveReference to false to disable the update on the
 state info.
<br/><br/>
 To speed up sequential IO, it has opened two IO Streams on the same FD.
 RandomAccessFile is used for random IO and seek. BufferedReader is used for
 sequential IO.  The speed-up is more than 10 times.
<br/></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>yannanlu@yahoo.com</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#DEBUG_BISECT">DEBUG_BISECT</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#DEBUG_INIT">DEBUG_INIT</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#DEBUG_LINE">DEBUG_LINE</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#DEBUG_LOCATE">DEBUG_LOCATE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#DEBUG_NEWLOG">DEBUG_NEWLOG</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#DEBUG_SAVE">DEBUG_SAVE</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#DEBUG_SCAN">DEBUG_SCAN</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#DEBUG_TIME">DEBUG_TIME</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.List&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#logBuffer">logBuffer</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#MAXLOGLENGTH">MAXLOGLENGTH</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#MAXNUMBERLOGS">MAXNUMBERLOGS</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#YEARMILLIS">YEARMILLIS</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#NewlogFetcher-java.util.Map-">NewlogFetcher</a></span>(java.util.Map&nbsp;props)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#close--">close</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#getLine--">getLine</a></span>()</code>
<div class="block">It returns a line as a String read from the input.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.util.List&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#getNewlogs--">getNewlogs</a></span>()</code>
<div class="block">It opens the log file and locates the first new entry according to
 the reference info, reads the all log entries from the location line
 by line up to the end of the logfile or until the buffer is full.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#getOffset--">getOffset</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#getPath--">getPath</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#getPosition--">getPosition</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#getTimestamp--">getTimestamp</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#getTimestamp-java.lang.String-">getTimestamp</a></span>(java.lang.String&nbsp;line)</code>
<div class="block">returns the timestamp in msec for the log entry or -1L otherwise</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#locateNewlog--">locateNewlog</a></span>()</code>
<div class="block">It locates the first new log entry according to the reference info of
 the logfile and returns the position of the EOF or new log entry.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#saveReference--">saveReference</a></span>()</code>
<div class="block">It flushes the current reference info to a given file for log tracking
 only if the SaveReference is enabled.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#saveReference-long-long-long-">saveReference</a></span>(long&nbsp;position,
             long&nbsp;timestamp,
             long&nbsp;offset)</code>
<div class="block">It flushes the specified reference info to the reference file for log
 tracking no matter the SaveReference is enabled or not.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#seek-long-">seek</a></span>(long&nbsp;pos)</code>&nbsp;</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#setReference-long-long-long-">setReference</a></span>(long&nbsp;position,
            long&nbsp;timestamp,
            long&nbsp;offset)</code>
<div class="block">It sets the current reference info.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#updateReference-long-">updateReference</a></span>(long&nbsp;offset)</code>&nbsp;</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/qbroker/common/NewlogFetcher.html#updateReference-long-long-long-">updateReference</a></span>(long&nbsp;position,
               long&nbsp;timestamp,
               long&nbsp;offset)</code>
<div class="block">It updates the current reference info.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="logBuffer">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logBuffer</h4>
<pre>public&nbsp;java.util.List&lt;java.lang.String&gt; logBuffer</pre>
</li>
</ul>
<a name="MAXNUMBERLOGS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MAXNUMBERLOGS</h4>
<pre>public static final&nbsp;int MAXNUMBERLOGS</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.MAXNUMBERLOGS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="MAXLOGLENGTH">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MAXLOGLENGTH</h4>
<pre>public static final&nbsp;int MAXLOGLENGTH</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.MAXLOGLENGTH">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="YEARMILLIS">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>YEARMILLIS</h4>
<pre>public static final&nbsp;long YEARMILLIS</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.YEARMILLIS">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEBUG_INIT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEBUG_INIT</h4>
<pre>public static final&nbsp;int DEBUG_INIT</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.DEBUG_INIT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEBUG_LOCATE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEBUG_LOCATE</h4>
<pre>public static final&nbsp;int DEBUG_LOCATE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.DEBUG_LOCATE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEBUG_BISECT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEBUG_BISECT</h4>
<pre>public static final&nbsp;int DEBUG_BISECT</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.DEBUG_BISECT">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEBUG_SCAN">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEBUG_SCAN</h4>
<pre>public static final&nbsp;int DEBUG_SCAN</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.DEBUG_SCAN">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEBUG_SAVE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEBUG_SAVE</h4>
<pre>public static final&nbsp;int DEBUG_SAVE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.DEBUG_SAVE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEBUG_LINE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEBUG_LINE</h4>
<pre>public static final&nbsp;int DEBUG_LINE</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.DEBUG_LINE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEBUG_TIME">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEBUG_TIME</h4>
<pre>public static final&nbsp;int DEBUG_TIME</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.DEBUG_TIME">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEBUG_NEWLOG">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEBUG_NEWLOG</h4>
<pre>public static final&nbsp;int DEBUG_NEWLOG</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.qbroker.common.NewlogFetcher.DEBUG_NEWLOG">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="NewlogFetcher-java.util.Map-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>NewlogFetcher</h4>
<pre>public&nbsp;NewlogFetcher(java.util.Map&nbsp;props)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="locateNewlog--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>locateNewlog</h4>
<pre>public&nbsp;long&nbsp;locateNewlog()
                  throws java.io.IOException</pre>
<div class="block">It locates the first new log entry according to the reference info of
 the logfile and returns the position of the EOF or new log entry.
 Reference info contains file position and timestamp of
 the reference log, and the offset from the objective log.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="getNewlogs--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNewlogs</h4>
<pre>public&nbsp;java.util.List&lt;java.lang.String&gt;&nbsp;getNewlogs()
                                            throws java.io.IOException</pre>
<div class="block">It opens the log file and locates the first new entry according to
 the reference info, reads the all log entries from the location line
 by line up to the end of the logfile or until the buffer is full.
 It stores them in the logBuffer.  It closes the log file and
 returns the List of new logs.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="setReference-long-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setReference</h4>
<pre>public&nbsp;void&nbsp;setReference(long&nbsp;position,
                         long&nbsp;timestamp,
                         long&nbsp;offset)</pre>
<div class="block">It sets the current reference info.  It is required that
 you have to provide all three arguments</div>
</li>
</ul>
<a name="updateReference-long-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateReference</h4>
<pre>public&nbsp;void&nbsp;updateReference(long&nbsp;position,
                            long&nbsp;timestamp,
                            long&nbsp;offset)</pre>
<div class="block">It updates the current reference info. Use it only after you have
 found a new log.  You have to provide all three arguments
<br/><br/>
 position: beginning of the new log entry
 timestamp: timestamp of the new log entry
 offset: length of the new log entry</div>
</li>
</ul>
<a name="updateReference-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateReference</h4>
<pre>public&nbsp;void&nbsp;updateReference(long&nbsp;offset)</pre>
</li>
</ul>
<a name="saveReference--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveReference</h4>
<pre>public&nbsp;void&nbsp;saveReference()
                   throws java.io.IOException</pre>
<div class="block">It flushes the current reference info to a given file for log tracking
 only if the SaveReference is enabled.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="saveReference-long-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveReference</h4>
<pre>public&nbsp;void&nbsp;saveReference(long&nbsp;position,
                          long&nbsp;timestamp,
                          long&nbsp;offset)
                   throws java.io.IOException</pre>
<div class="block">It flushes the specified reference info to the reference file for log
 tracking no matter the SaveReference is enabled or not.  It is designed
 for public to control the log tracking only.  So you have to provide
 all three arguments with care and disable the SaveReference to prevent
 the reference log from overwritten by NewlogFetcher itself.  Please also
 make sure the reference file is defined.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="getTimestamp-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimestamp</h4>
<pre>public&nbsp;long&nbsp;getTimestamp(java.lang.String&nbsp;line)</pre>
<div class="block">returns the timestamp in msec for the log entry or -1L otherwise</div>
</li>
</ul>
<a name="getTimestamp--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimestamp</h4>
<pre>public&nbsp;long&nbsp;getTimestamp()</pre>
</li>
</ul>
<a name="getPosition--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPosition</h4>
<pre>public&nbsp;long&nbsp;getPosition()</pre>
</li>
</ul>
<a name="getOffset--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOffset</h4>
<pre>public&nbsp;long&nbsp;getOffset()</pre>
</li>
</ul>
<a name="getPath--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPath</h4>
<pre>public&nbsp;java.lang.String&nbsp;getPath()</pre>
</li>
</ul>
<a name="getLine--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLine</h4>
<pre>public&nbsp;java.lang.String&nbsp;getLine()
                         throws java.io.IOException</pre>
<div class="block">It returns a line as a String read from the input.
 The char of newline, '\n', will be at the end of the line.
 In case of empty input, it returns null.
<br/>
 NB. make sure the buffer is reset at close of the InputStream
 It is not MT-Safe due to buffer, leftover, and startBytes</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="seek-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>seek</h4>
<pre>public&nbsp;void&nbsp;seek(long&nbsp;pos)
          throws java.io.IOException</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a name="close--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;close()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/qbroker/common/LongKeyChain.html" title="class in org.qbroker.common"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../org/qbroker/common/NonSQLException.html" title="class in org.qbroker.common"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/qbroker/common/NewlogFetcher.html" target="_top">Frames</a></li>
<li><a href="NewlogFetcher.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
