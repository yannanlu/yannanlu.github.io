<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Fri May 12 16:04:04 EDT 2017 -->
<title>MessageStream</title>
<meta name="date" content="2017-05-12">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="MessageStream";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/qbroker/jms/MessagePacket.html" title="class in org.qbroker.jms"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../org/qbroker/jms/MessageUtils.html" title="class in org.qbroker.jms"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/qbroker/jms/MessageStream.html" target="_top">Frames</a></li>
<li><a href="MessageStream.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.qbroker.jms</div>
<h2 title="Class MessageStream" class="title">Class MessageStream</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.qbroker.jms.MessageStream</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">MessageStream</span>
extends java.lang.Object</pre>
<div class="block">MessageStream handles Stream IO on JMS Messages.  The Stream has to be
 established before using this object.
<br/><br/>
 There are four methods, read(), write(), request() and respond() on Stream.
 The method of read() is MT-Safe.  If read() gets the end of stream,
 it will stop and return.  The method of write() is for asynchronous
 output whereas request() is for synchronous requests. For testing purpose,
 MessageStream supports two methods, echo() and collect().
<br/><br/>
 MessageStream reacts on EOF differently according to the Mode.  If its value
 is set to command mode, read() just exits when an EOF is read.  For Linux
 comm port,  the timeout implementation returns an EOF.  Therefore, setting
 the value to ignore mode will have most of read operation to ignore the EOF
 and continue to read.  If the value is set to daemon, read() will throw an
 IOException whenever it reads an EOF to indicate end of stream unexpectedly.
<br/><br/>
 In case of charSet and encoding, you can overwrite the default encoding by
 starting JVM with "-Dfile.encoding=ISO8859_1 your_class".
<br/></div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>yannanlu@yahoo.com</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#MessageStream(java.util.Map)">MessageStream</a></strong>(java.util.Map&nbsp;props)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#collect(java.io.InputStream, org.qbroker.common.XQueue, int)">collect</a></strong>(java.io.InputStream&nbsp;in,
       <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
       int&nbsp;timeout)</code>
<div class="block">collects the response for a request for testing purpose</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#echo(org.qbroker.common.XQueue)">echo</a></strong>(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)</code>
<div class="block">echoes the message back for testing purpose</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#getEotBytes()">getEotBytes</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#getOffhead()">getOffhead</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#getOfftail()">getOfftail</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#getOperation()">getOperation</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#getSotBytes()">getSotBytes</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#read(java.io.InputStream, org.qbroker.common.XQueue)">read</a></strong>(java.io.InputStream&nbsp;in,
    <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)</code>
<div class="block">It reads the byte stream from an InputStream, packages them
 into JMS Messages and adds the messages to an XQueue.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#read(java.io.InputStream, org.qbroker.common.XQueue, java.lang.String[], java.lang.String[])">read</a></strong>(java.io.InputStream&nbsp;in,
    <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
    java.lang.String[]&nbsp;pNames,
    java.lang.String[]&nbsp;pValues)</code>
<div class="block">It reads the byte stream from an InputStream, packages them into
 JMS Messages and sets the properties before adding the messages to
 an XQueue.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#request(java.io.InputStream, org.qbroker.common.XQueue, java.io.OutputStream)">request</a></strong>(java.io.InputStream&nbsp;in,
       <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
       java.io.OutputStream&nbsp;out)</code>
<div class="block">It listens on an XQueue for an incoming JMS messages and writes all
 bytes to an OutputStream as the request.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#request(java.io.InputStream, org.qbroker.common.XQueue, java.io.OutputStream, org.qbroker.common.QList, org.qbroker.common.DelimitedBuffer)">request</a></strong>(java.io.InputStream&nbsp;in,
       <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
       java.io.OutputStream&nbsp;out,
       <a href="../../../org/qbroker/common/QList.html" title="class in org.qbroker.common">QList</a>&nbsp;msgList,
       <a href="../../../org/qbroker/common/DelimitedBuffer.html" title="class in org.qbroker.common">DelimitedBuffer</a>&nbsp;sBuf)</code>
<div class="block">It listens on an XQueue for incoming JMS messages and writes all
 bytes to an OutputStream as the requests.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#respond(java.io.InputStream, org.qbroker.common.XQueue, java.io.OutputStream, org.qbroker.common.QList, org.qbroker.common.DelimitedBuffer, org.qbroker.common.CollectibleCells)">respond</a></strong>(java.io.InputStream&nbsp;in,
       <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
       java.io.OutputStream&nbsp;out,
       <a href="../../../org/qbroker/common/QList.html" title="class in org.qbroker.common">QList</a>&nbsp;msgList,
       <a href="../../../org/qbroker/common/DelimitedBuffer.html" title="class in org.qbroker.common">DelimitedBuffer</a>&nbsp;sBuf,
       <a href="../../../org/qbroker/common/CollectibleCells.html" title="class in org.qbroker.common">CollectibleCells</a>&nbsp;cells)</code>
<div class="block">It reads the byte stream from an InputStream, packages them into
 JMS Messages and adds the messages to an XQueue as the request.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../org/qbroker/jms/MessageStream.html#write(org.qbroker.common.XQueue, java.io.OutputStream)">write</a></strong>(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
     java.io.OutputStream&nbsp;out)</code>
<div class="block">It gets JMS Messages from an XQueue and write all bytes to the
 OutputStream continuously.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="MessageStream(java.util.Map)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MessageStream</h4>
<pre>public&nbsp;MessageStream(java.util.Map&nbsp;props)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="read(java.io.InputStream, org.qbroker.common.XQueue)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre>public&nbsp;long&nbsp;read(java.io.InputStream&nbsp;in,
        <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)
          throws java.io.IOException,
                 javax.jms.JMSException</pre>
<div class="block">It reads the byte stream from an InputStream, packages them
 into JMS Messages and adds the messages to an XQueue.
 It supports flexible but static delimiters at either
 or both ends.  It also has the blind trim support at both ends.
<br/><br/>
 Most of the IOExceptions from the stream IO operations, like read,
 will be thrown to notify the caller.  The caller is supposed to catch
 the exception, either to reset the stream or to do other stuff.
 It also throws JMSException from the operations regarding to the message
 itself, like get/set JMS properties.  This does not require to reset
 the stream at all.
<br/><br/>
 This is MT-Safe as long as the threads share the same offhead,
 offtail, sotBytes and eotBytes.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="read(java.io.InputStream, org.qbroker.common.XQueue, java.lang.String[], java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre>public&nbsp;long&nbsp;read(java.io.InputStream&nbsp;in,
        <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
        java.lang.String[]&nbsp;pNames,
        java.lang.String[]&nbsp;pValues)
          throws java.io.IOException,
                 javax.jms.JMSException</pre>
<div class="block">It reads the byte stream from an InputStream, packages them into
 JMS Messages and sets the properties before adding the messages to
 an XQueue.  It supports flexible but static delimiters at either
 or both ends.  It also has the blind trim support at both ends.
 At the end, it returns number of messages read from input stream.
<br/><br/>
 Most of the IOExceptions from the stream IO operations, like read,
 will be thrown to notify the caller.  The caller is supposed to catch
 the exception, either to reset the stream or to do other stuff.
 It also throws JMSException from the operations regarding to the message
 itself, like get/set JMS properties.  This does not require to reset
 the stream at all.
<br/><br/>
 The class variable controls the reaction on EOF.  If the value is set to
 command mode, it just exits when an EOF is read.  For Linux comm port,  
 the timeout implementation returns EOF.  Therefore, setting the value
 to ignore mode will have the method to ignore EOF and continue to read.  
 If the value is set to daemon, it will throw IOException whenever it
 reads an EOF to indicate connection reset by peer.
<br/><br/>
 This is MT-Safe as long as the threads share the same offhead,
 offtail, sotBytes and eotBytes.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="respond(java.io.InputStream, org.qbroker.common.XQueue, java.io.OutputStream, org.qbroker.common.QList, org.qbroker.common.DelimitedBuffer, org.qbroker.common.CollectibleCells)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>respond</h4>
<pre>public&nbsp;long&nbsp;respond(java.io.InputStream&nbsp;in,
           <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
           java.io.OutputStream&nbsp;out,
           <a href="../../../org/qbroker/common/QList.html" title="class in org.qbroker.common">QList</a>&nbsp;msgList,
           <a href="../../../org/qbroker/common/DelimitedBuffer.html" title="class in org.qbroker.common">DelimitedBuffer</a>&nbsp;sBuf,
           <a href="../../../org/qbroker/common/CollectibleCells.html" title="class in org.qbroker.common">CollectibleCells</a>&nbsp;cells)
             throws java.io.IOException,
                    javax.jms.JMSException</pre>
<div class="block">It reads the byte stream from an InputStream, packages them into
 JMS Messages and adds the messages to an XQueue as the request.  Then
 it continually monitors the XQueue for the reply messages.  If it finds
 one, the message will be sent back to the OutputStream associated with
 the InputStream as the response.  Since there is no blocking between
 the request and the response, it is possible for the thread to process
 two requests before any response sent back.  In order for the requester
 to tell a response is corresponding to which request, each request
 message should contains an ID even though it is unknown to this method.
 So the downstream message flow is not supposed to modify or remove that
 ID.  It supports flexible but static delimiters at either or both ends.
 It also has the blind trim support at both ends.
<br/><br/>
 The msgList is a dedicated instance of QList for tracking the
 collectible responses. The sBuf is also a dedicated buffer with
 delimiter supports. The last argument is a dedicate instance of
 CollectibleCells for reverse propagations.  Its capacity should be same
 as the xq.
<br/><br/>
 Most of the IOExceptions from the stream IO operations, like read,
 will be thrown to notify the caller.  The caller is supposed to catch
 the exception, either to reset the stream or to do other stuff.
 It also throws JMSException from the operations regarding to the message
 itself, like get/set JMS properties.  This does not require to reset
 the stream at all.
<br/><br/>
 To support re-entrance, it depends on msgList and sBuf for state info.
 Please make sure sBuf has the same properties as the instance.
 This is MT-Safe as long as the threads share the same offhead, offtail,
 sotBytes and eotBytes.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="request(java.io.InputStream, org.qbroker.common.XQueue, java.io.OutputStream, org.qbroker.common.QList, org.qbroker.common.DelimitedBuffer)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>request</h4>
<pre>public&nbsp;long&nbsp;request(java.io.InputStream&nbsp;in,
           <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
           java.io.OutputStream&nbsp;out,
           <a href="../../../org/qbroker/common/QList.html" title="class in org.qbroker.common">QList</a>&nbsp;msgList,
           <a href="../../../org/qbroker/common/DelimitedBuffer.html" title="class in org.qbroker.common">DelimitedBuffer</a>&nbsp;sBuf)
             throws java.io.IOException,
                    javax.jms.JMSException,
                    <a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a></pre>
<div class="block">It listens on an XQueue for incoming JMS messages and writes all
 bytes to an OutputStream as the requests.  Meanwhile, it reads the
 byte stream from the InputStream associated with the OutputStream,
 loads them into the request messages and removes them from the XQueue
 as the responses.  In order to track the incoming responses, it will
 add the SID to the rcField of each outgoing message.  Whoever receives
 the request should ensure the response message also contains the same
 SID.  Hence this method will be able to retrieve the SID and
 to associate the response with the request.  It also supports flexible
 but static delimiters at either or both ends.  It also has the blind
 trim support at both ends.
<br/><br/>
 Most of the IOExceptions from the stream IO operations, like read,
 will be thrown to notify the caller.  The caller is supposed to catch
 the exception, either to reset the stream or to do other stuff.
 It also throws JMSException from the operations regarding to the message
 itself, like get/set JMS properties.  This does not require to reset
 the stream at all.
<br/><br/>
 Since the request operation relies on a request, this method will
 intercept the request and process it.  The incoming message is required
 to be writeable.  The method will set a String property of the message
 specified by the RCField with the return code, indicating the status
 of the process to fulfill the request.  The requester is required to
 check the value of the property once it gets the message back.  If
 the return code is 0, the request is successful.  This method will not
 acknowledge messages.  It is up to the requester to do that.
<br/><br/>
 To support multi-plexing, it depends on msgList and sBuf to track the
 pending requests and the state info. It does not support re-entrance.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.jms.JMSException</code></dd>
<dd><code><a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a></code></dd></dl>
</li>
</ul>
<a name="request(java.io.InputStream, org.qbroker.common.XQueue, java.io.OutputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>request</h4>
<pre>public&nbsp;long&nbsp;request(java.io.InputStream&nbsp;in,
           <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
           java.io.OutputStream&nbsp;out)
             throws java.io.IOException,
                    <a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a>,
                    javax.jms.JMSException</pre>
<div class="block">It listens on an XQueue for an incoming JMS messages and writes all
 bytes to an OutputStream as the request.  After the write operation,
 it reads the byte stream from the InputStream associated with the
 OutputStream until the pattern is hit.  Then it loads all the bytes
 into the request message and removes it from the XQueue as the
 response.  Both write and read operations block the message flow.
 Therefore, there is no need to track SID for each messages.
 It supports flexible terminate patterns with timeout.
<br/><br/>
 Most of the IOExceptions from the stream IO operations, like read,
 will be thrown to notify the caller.  The caller is supposed to catch
 the exception, either to reset the stream or to do other stuff.
 It also throws JMSException from the operations regarding to the message
 itself, like get/set JMS properties.  This does not require to reset
 the stream at all.
<br/><br/>
 Since the request operation relies on a request, this method will
 intercept the request and process it.  The incoming message is required
 to be writeable.  The method will set a String property of the message
 specified by the RCField with the return code, indicating the status
 of the process to fulfill the request.  The requester is required to
 check the value of the property once it gets the message back.  If
 the return code is 0, the request is successful.  This method will not
 acknowledge messages.  It is up to the requester to do that.
<br/><br/>
 It is NOT MT-safe.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a></code></dd>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="write(org.qbroker.common.XQueue, java.io.OutputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>write</h4>
<pre>public&nbsp;long&nbsp;write(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
         java.io.OutputStream&nbsp;out)
           throws java.io.IOException,
                  <a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a>,
                  javax.jms.JMSException</pre>
<div class="block">It gets JMS Messages from an XQueue and write all bytes to the
 OutputStream continuously.
<br/><br/>
 Most of the IOExceptions from the stream IO operations, like write,
 will be thrown to notify the caller.  The caller is supposed to catch
 the exception, either to reset the stream or to do other stuff.
 It also throws JMSException from the operations regarding to the message
 itself, like get/set JMS properties.  This does not require to reset
 the stream at all.
<br/><br/>
 If the MaxIdleTime is set to none-zero, it will monitor the idle time
 and will throw TimeoutException once the idle time exceeds MaxIdleTime.
 it is up to the caller to handle this exception.
<br/><br/>
 It will not modify the original messages.  If the XQueue has enabled
 the EXTERNAL_XA, it will also acknowledge every messages.  This method
 is MT-Safe.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="../../../org/qbroker/common/TimeoutException.html" title="class in org.qbroker.common">TimeoutException</a></code></dd>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="collect(java.io.InputStream, org.qbroker.common.XQueue, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>collect</h4>
<pre>public&nbsp;void&nbsp;collect(java.io.InputStream&nbsp;in,
           <a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq,
           int&nbsp;timeout)
             throws javax.jms.JMSException</pre>
<div class="block">collects the response for a request for testing purpose</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="echo(org.qbroker.common.XQueue)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>echo</h4>
<pre>public&nbsp;void&nbsp;echo(<a href="../../../org/qbroker/common/XQueue.html" title="interface in org.qbroker.common">XQueue</a>&nbsp;xq)
          throws javax.jms.JMSException</pre>
<div class="block">echoes the message back for testing purpose</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>javax.jms.JMSException</code></dd></dl>
</li>
</ul>
<a name="getOperation()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOperation</h4>
<pre>public&nbsp;java.lang.String&nbsp;getOperation()</pre>
</li>
</ul>
<a name="getSotBytes()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSotBytes</h4>
<pre>public&nbsp;byte[]&nbsp;getSotBytes()</pre>
</li>
</ul>
<a name="getEotBytes()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEotBytes</h4>
<pre>public&nbsp;byte[]&nbsp;getEotBytes()</pre>
</li>
</ul>
<a name="getOfftail()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOfftail</h4>
<pre>public&nbsp;int&nbsp;getOfftail()</pre>
</li>
</ul>
<a name="getOffhead()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getOffhead</h4>
<pre>public&nbsp;int&nbsp;getOffhead()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/qbroker/jms/MessagePacket.html" title="class in org.qbroker.jms"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../org/qbroker/jms/MessageUtils.html" title="class in org.qbroker.jms"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/qbroker/jms/MessageStream.html" target="_top">Frames</a></li>
<li><a href="MessageStream.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
